(()=>{console.log("Content script loaded");var n=null;function o(n,o){var t=n*(o/100),e=n+t;document.getElementById("added-amount").innerText="You will donate: $".concat(t.toFixed(2)," (").concat(o,"%)"),document.getElementById("total-with-donation").innerText="Total After Donation: $".concat(e.toFixed(2))}window.location.href.includes("nav_cart")||window.location.href.includes("sepet")||window.location.href.includes("sepetim")?(console.log("URL includes nav_cart or sepet or sepetim, fetching subtotal price"),window.location.href.includes("amazon")?function(){var o=document.querySelector("#sc-subtotal-amount-activecart span, #sc-subtotal-amount-buybox span");if(o){var t=o.textContent.trim(),e=parseFloat(t.replace(/[^\d,]/g,"").replace(/,/g,"").replace(/\./g,""))/100;isNaN(e)?console.log("Failed to parse subtotal price on Amazon"):(n=e,chrome.storage.local.set({lastTotalPrice:n},(function(){console.log("Subtotal price saved: ".concat(e))})))}else console.log("Subtotal price element not found on Amazon")}():window.location.href.includes("trendyol")?fetchSubtotalPriceTrendyol():window.location.href.includes("hepsiburada")&&fetchSubtotalPriceHepsiburada()):(window.location.href.includes("from=cheetah")||window.location.href.includes("isProceedPayment=true")||window.location.href.includes("odeme"))&&(console.log("URL includes from=cheetah or odeme, displaying popup"),chrome.storage.local.get(["lastTotalPrice"],(function(n){if(n.lastTotalPrice){var t=n.lastTotalPrice,e=.1*t,a=t+e,r='<div class="popup-overlay">\n                    <div class="popup">\n                        <div class="popup-content">\n                            <button class="close">&times;</button>\n                            <p class="popup-text">The total cost is $'.concat(t.toFixed(2),'.</p>\n                            <div class="percentage-buttons">\n                                <div class="button-row">\n                                    <button class="percent-btn" data-percent="5">5%</button>\n                                    <button class="percent-btn" data-percent="10">10%</button>\n                                </div>\n                                <div class="button-row">\n                                    <button class="percent-btn" data-percent="20">20%</button>\n                                    <input type="number" class="custom-input" id="custom-input" placeholder="Custom %" min="1" />\n                                </div>\n                            </div>\n                            <p class="popup-text" id="added-amount">You will donate: $').concat(e.toFixed(2),' (10%)</p>\n                            <p class="popup-text" id="total-with-donation">Total After Donation: $').concat(a.toFixed(2),'</p>\n                            <button id="donate-button">Donate</button>\n                            <button id="no-button">No</button>\n                        </div>\n                    </div>\n                </div>');document.body.insertAdjacentHTML("beforeend",r),document.querySelector(".close").addEventListener("click",(function(){document.querySelector(".popup-overlay").remove()})),document.querySelectorAll(".percent-btn").forEach((function(n){n.addEventListener("click",(function(){var n=parseInt(this.getAttribute("data-percent"));o(t,n)}))})),document.querySelector("#custom-input").addEventListener("input",(function(){var n=parseFloat(this.value);isNaN(n)||o(t,n)})),o(t,10),document.querySelector("#donate-button").addEventListener("click",(function(){var n,o;n=e,(o=window.open("https://www.redcross.org/donate/donation.html/","_blank")).onload=function(){var t='\n            <div style="position: fixed; bottom: 20px; right: 20px; background-color: white; border: 1px solid #ddd; padding: 10px; box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.1); z-index: 9999; font-family: Arial, sans-serif;">\n                <p style="color: green; font-size: 16px; font-weight: bold;">You are about to donate: $'.concat(n.toFixed(2),'</p>\n                <p style="font-size: 12px; color: #555;">Please enter this amount in the "Other Amount" field</p>\n            </div>\n        '),e=o.document.createElement("div");e.innerHTML=t,o.document.body.appendChild(e)},document.querySelector(".popup-overlay").remove()})),document.querySelector("#no-button").addEventListener("click",(function(){document.querySelector(".popup-overlay").remove()}))}else console.warn("No saved total price available to display after navigation")}))),chrome.storage.local.get(["lastTotalPrice"],(function(o){o.lastTotalPrice&&(n=o.lastTotalPrice,console.log("Restored last total price from local storage:",n))}));var t=document.createElement("style");t.innerHTML="\n    .popup-overlay {\n        position: fixed;\n        top: 0;\n        left: 0;\n        width: 100%;\n        height: 100%;\n        background: rgba(0, 0, 0, 0.7);\n        z-index: 10001;\n        display: flex;\n        justify-content: center;\n        align-items: center;\n    }\n\n    .popup {\n        background-color: #fff;\n        color: #333;\n        padding: 30px;\n        border-radius: 8px;\n        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n        width: 350px;\n        text-align: center;\n        font-family: Arial, sans-serif;\n    }\n    \n    .popup-content {\n        position: relative;\n    }\n\n    .close {\n        position: absolute;\n        top: 10px;\n        right: 10px;\n        background: none;\n        border: none;\n        color: #333;\n        font-size: 20px;\n        cursor: pointer;\n    }\n\n    .popup-text {\n        color: #333;\n        font-size: 18px;\n        margin: 15px 0;\n    }\n\n    .percentage-buttons {\n        margin: 15px 0;\n    }\n\n    .button-row {\n        display: flex;\n        justify-content: space-between;\n        margin: 5px 0;\n    }\n\n    .percent-btn {\n        background-color: #007BFF;\n        color: white;\n        border: none;\n        padding: 10px;\n        font-size: 16px;\n        border-radius: 4px;\n        flex: 1;\n        margin: 0 5px;\n        cursor: pointer;\n    }\n\n    .percent-btn:hover {\n        background-color: #0056b3;\n    }\n\n    .custom-input {\n        flex: 1;\n        padding: 10px;\n        font-size: 16px;\n        border-radius: 4px;\n        border: 1px solid #ccc;\n        width: 70px;\n        margin: 0 5px;\n        text-align: center;\n    }\n\n    #donate-button, #no-button {\n        background-color: #007BFF;\n        color: white;\n        border: none;\n        padding: 12px;\n        font-size: 16px;\n        border-radius: 4px;\n        cursor: pointer;\n        width: 100%;\n        margin: 10px 0;\n    }\n\n    #donate-button:hover, #no-button:hover {\n        background-color: #0056b3;\n    }\n",document.head.appendChild(t)})();